/*
 tipJS - OpenSource Javascript MVC Framework ver.2.1.3
 Copyright 2013.08 tipJS-Team
 Dual licensed under the MIT or GPL Version 2 licenses
 Author: SeungHyun PAEK, Hanghee Yi, Juntai Park, Yun Jung Bu
 HomePage: http://tipjs-team.github.io/tipJS/
 GitHub: https://github.com/tipJS-Team/tipJS
 License: MIT, GPL V2
 create date: 2013-11-11 */
!function(a){"use strict";var b={};b.ver=b.version=b.VERSION="2.1.3",a.tipJS=b;for(var c=b.util={},d=Object.prototype.toString,e=["Arguments","Function","Number","String","Date","RegExp","Boolean"],f=function(a){c["is"+a]=function(b){return d.call(b)==="[object "+a+"]"}},g=0,h=e.length;h>g;g++)f(e[g]);c.isArray=Array.isArray||function(a){return"[object Array]"===d.call(a)},c.isObject=function(a){return a===Object(a)},c.toArray=function(a){var b,c,d;if(b=[],a.length)for(c=0,d=a.length;d>c;c++)b[c]=a[c];return b},c.getById=function(a,b){return b?b.getElementById(a):document.getElementById(a)},c.getByName=function(a,b){return b?b.getElementsByName(a):document.getElementsByName(a)},c.getByTag=function(a,b){return b?b.getElementsByTagName(a):document.getElementsByTagName(a)},c.mergeObject=function(a,b){var c;for(c in b)a[c]||(a[c]=b[c]);return a},c.cloneObject=function(a,b){var d,e;if(null==a||"object"!=typeof a)return a;if(b)return i(a);d=a instanceof Array?[]:{};for(e in a)d[e]="object"==typeof a[e]?c.cloneObject(a[e],!1):a[e];return d},c.hasChild=function(a){var b;for(b in a)if("object"==typeof a[b])return!0;return!1},c.uniqArray=function(a){var b,c,d=[],e=a.length;for(b=0;e>b;b++){for(c=b+1;e>c;c++)a[b]===a[c]&&(c=++b);d.push(a[b])}return d},c.loadJS=function(a,b){var d=document.createElement("script");d.type="text/javascript",d.src=T.define?T.define.getNoCacheUrl(a):a,b&&(d.readyState?d.onreadystatechange=function(){("loaded"==this.readyState||"complete"==this.readyState)&&(this.onreadystatechange=null,b(this))}:d.onload=function(){b(this)}),c.getByTag("head")[0].appendChild(d)};var i=function(a){return i=c.isFunction(Object.create)?function(a){return Object.create(a)}:function(a){function b(){}return b.prototype=a,new b},i(a)},j=b.echo=function(a,b,c){var d;if(!c||!("string"!=typeof c||"string"==typeof c&&c.split(".").length+c.split("]").length>3)){if(b||(b=""),null===a||void 0===a)return console.log((c?c+".":"")+a),void 0;if("object"!=typeof a)return(typeof a==b||""===b)&&console.log((c?c+".":"")+a+"["+typeof a+"]"),void 0;a instanceof Array?console.log((c?c+":":"")+"[Array["+a.length+"]]"):console.log((c?c+":":"")+"[Object]");for(d in a)a instanceof Array?"object"==typeof a[d]?j(a[d],b,(c?c+"[":"[")+d+(c?"]":"]")):(typeof a[d]==b||""===b)&&console.log((c?c+"[":"[")+d+(c?"]":"]")+":"+a[d]+" ("+typeof a[d]+")"):"object"==typeof a[d]?j(a[d],b,(c?c+".":"")+d):(typeof a[d]==b||""===b)&&console.log((c?c+".":"")+d+":"+a[d]+" ("+typeof a[d]+")")}},k=function(a){return"Please define "+a},l=function(a,b){var d;if(c.isArray(a))for(d=a.length;d--;){if(a[d]==b)return!0;if(a==b)return!0}return!1},m=function(a,b){var d,e=a.__extend;if(!e)return a;if(c.isString(e))a=n(a,e,b);else if(e instanceof Array)for(d=e.length;d--;)a=n(a,e[d],b);return a},n=function(a,b,d){return"model"==d?c.mergeObject(a,c.cloneObject(u(b))):c.mergeObject(a,c.cloneObject(v(b)))},o=function(){return o=Date.now?function(){return Date.now()}:function(){return+new Date},o()},p=function(a,b,c,d){window.addEventListener?p=function(a,b,c,d){void 0===d&&(d=!1),a.addEventListener(b,c,d)}:window.attachEvent&&(p=function(a,b,c){return"hashchange"!=b||"onhashchange"in window?(a.attachEvent("on"+b,c),void 0):(W.push(c),void 0)}),p(a,b,c,d)},q=function(){var a,b,c;"onhashchange"in window||(a=location.hash,setInterval(function(){if(a!=location.hash)for(a=location.hash,b=0,c=W.length;c>b;b++)W[b]()},200))},r=function(a,d,e){if(!c.isObject(e))throw new Error(k(a));if(!c.isString(d))throw new Error(k(a));if(e.__extend&&"controllers"!=a&&"interceptors"!=a&&l(e.__extend,d))throw new Error("Can't extend itself: "+d);if(!T)throw new Error(k(a));if(T.loadOrder.presentOrder()===a||b.isRelease)switch(a){case"interceptors":case"controllers":case"models":case"views":P[a][d]=e}},s=function(a,d){var e,f,g,h=T.define.path[d],i=a.appPath?a.appPath:".";if("lang"===d&&a.localSet)return a[d]=[i+"/"+h+"/"+b.lang+".js"],a[d];if("tipJSRelease"===d)return a[d]=[i+"/"+T.define.releaseFile],a[d];for(e=c.uniqArray(a[d]),g=[],f=e.length;f--;)g.push(i+"/"+h+"/"+e[f]);return g},t=function(a){var b,d;if(O[a]=O[a]||{},b=O[a].requireList=s(T.define,a),b.length>0)for(d=b.length;d--;)c.loadJS(b[d],function(b){F(a,b.src)&&E()});else E()},u=function(a,b){var d,e,f,g=P.models;if(!g[a]||void 0===g[a])throw new Error("Can't find model: "+a);return b===!0?(d=P.syncModels,d||(d=P.syncModels={}),d[a]?d[a]:(e=d[a]=c.cloneObject(g[a],Y["models"+a]),c.isFunction(e.__init)&&e.__init(),e)):(f=c.cloneObject(g[a],Y["models"+a]),c.isFunction(f.__init)&&f.__init(),f)},v=function(a){var b,d=P.views;if(!d||!d[a]||void 0===d[a])throw new Error("Can't find view: "+a);return b=c.cloneObject(d[a],Y["views"+a]),c.isFunction(b.__init)&&b.__init(),b},w=function(){var a,d,e,f=P.controllers;for(a in f)d=c.cloneObject(f[a]),e={controllerName:a,getModel:u,getView:v,render:H,getById:c.getById,getByName:c.getByName,getByTag:c.getByTag},b.action[a]=function(a,d){return function(){var e,f,g=arguments;b.isDevelopment===!0&&(e=o()),T.define.beforeController&&T.define.beforeController.apply(a,arguments)===!1||(f=function(){if(d.exceptionInvoke)try{x(d,g)}catch(f){(g=c.toArray(g)).unshift(f),d.exceptionInvoke.apply(d,g)}else x(d,g);T.define.afterController&&T.define.afterController.apply(a,g),b.isDevelopment===!0&&b.debug(a.controllerName+" completed in "+(o()-e)/1e3+" seconds")},d.async===!0?setTimeout(f,d.delay?d.delay:15):f())}}(e,d)},x=function(a,b){a.beforeInvoke&&a.beforeInvoke.apply(a,b)===!1||a.invoke&&a.invoke.apply(a,b)===!1||a.afterInvoke&&a.afterInvoke.apply(a,b)},y=function(){var a,b,d,e,f,g,h=P.interceptors;for(g in h)b=d=e=[],a=h[g],f=a.order?a.order:0,a.target&&(b=c.isArray(a.target)?a.target:[a.target]),a.before&&(d=c.isArray(a.before)?a.before:[a.before]),a.after&&(e=c.isArray(a.after)?a.after:[a.after]),Q.push({order:f,scope:b,before:d,after:e});Q.sort(function(a,b){return a.order-b.order})},z=function(a,b,c){return function(){var d,e,f,g=c.before;for(e=0,f=g.length;f>e;e++)if(d=g[e].apply(b,arguments),void 0!==d)return d;return d=a.apply(b,arguments),void 0!==d?d:void 0}},A=function(a,b,c){return function(){var d,e,f,g=c.after;if(d=a.apply(b,arguments),void 0!==d)return d;for(e=0,f=g.length;f>e;e++)if(d=g[e].apply(b,arguments),void 0!==d)return d}},B=function(a,b,d,e){var f,g,h,i,j,k=b.split("."),l=P[a];if(1!=k.length||a!=b&&a+"*"!=b){if(2==k.length&&a==k[0]){i=k[1];for(f in l)if(f==i||i.indexOf("*")>0&&0==f.indexOf(i.substr(0,i.indexOf("*")))){h=l[f];for(g in h)c.isFunction(h[g])&&(h[g]=e(h[g],h,d))}}else if(3==k.length&&a==k[0]){i=k[1],j=k[2];for(f in l)if(f==i){h=l[f];for(g in h)(g==j||j.indexOf("*")>0&&0==g.indexOf(j.substr(0,j.indexOf("*"))))&&c.isFunction(h[g])&&(h[g]=e(h[g],h,d))}}}else for(f in l){h=l[f];for(g in h)c.isFunction(h[g])&&(h[g]=e(h[g],h,d))}},C=function(a){var b,c,d,e,f,g;for(b=Q.length;b--;)for(f=Q[b],g=f.scope,d=0,e=g.length;e>d;d++)B(a,g[d],f,z);for(b=0,c=Q.length;c>b;b++)for(f=Q[b],g=f.scope,d=0,e=g.length;e>d;d++)B(a,g[d],f,A)},D=function(a){var c;V[a.url]=a.controller,p(window,"hashchange",function(){c=location.hash,K!=c&&(K=c,0==c.length&&V["/"]?b.action[V["/"]]():V[c]?b.action[V[c]]():V["!"]&&b.action[V["!"]]())})},E=function(){var a,d,e,f,g,h,i,j,k,l,n,o;if(T.loadOrder.isLastOrder()===!1)return t(T.loadOrder.nextOrder()),void 0;if(y(),e=P.controllers){C("controllers");for(a in e)e[a].getModel=u,e[a].getView=v,e[a].render=H,e[a].getById=c.getById,e[a].getByName=c.getByName,e[a].getByTag=c.getByTag;w()}if(f=P.models){C("models");for(a in f)d=a,m(f[a],"model"),d.lastIndexOf("VO")!=d.length-2&&(f[a].getModel=u,f[a].getById=c.getById,f[a].getByName=c.getByName,f[a].getByTag=c.getByTag),Y["models"+d]=!c.hasChild(f[a])}if(g=P.views){C("views");for(a in g)d=a,m(g[a],"view"),g[a].getView=v,g[a].render=H,g[a].getById=c.getById,g[a].getByName=c.getByName,g[a].getByTag=c.getByTag,Y["views"+d]=!c.hasChild(g[a])}if(b.debug("tipJS version "+b.version+"["+b.lang+"]"),c.isArray(T.onLoadArgs)||(T.onLoadArgs=[]),T.define.onLoad.apply(T.define,T.onLoadArgs),L){for(h=0,i=L.length;i>h;h++)j=L[h],k=b.action[j.name],k.apply(k,j.param);L=null}for(h=0,l=T.define.routes.length;l>h;h++)n=T.define.routes[h],D(n);l>0&&(q(),o=K=location.hash,0==o.length&&V["/"]?b.action[V["/"]]():V[o]?b.action[V[o]]():V["!"]&&b.action[V["!"]]())},F=function(a,b){var c,d,e=O[a].requireList;for(c=e.length;c--;)if(e[c]!==!0&&(d=e[c].indexOf("./")>-1?e[c].substr(e[c].lastIndexOf("./")+1):e[c],b.indexOf(d)>-1)){e[c]=!0;break}for(c=e.length;c--;)if(e[c]!==!0)return!1;return!0};b.benchmark={},b.benchmark.mark=function(a){S[a]=o()},b.benchmark.elapsedTime=function(a,c,d){var e,f,g;return e=S[a],f=S[c],g=(f-e)/1e3,d?d(a,c,e,f,g):b.log("elapsed time["+a+" to "+c+"] : "+g+" seconds","[BENCHMARK]"),g};var G=function(){var a=!1;if(window.XMLHttpRequest)a=new XMLHttpRequest;else if(window.ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}return G=function(){return a},G()},H=b.render=function(a){var b;if(arguments.length>1)return I(arguments[0],arguments[1],arguments[2]);if(T.define.templateCache&&X[a.url])return b=I(X[a.url],a.data,a.tplId),c.isString(a.renderTo)&&(c.getById(a.renderTo).innerHTML+=b),b;var d=G();d.open("GET",T.define.getNoCacheUrl(a.url),!1);try{d.send(null)}catch(e){return null}if(4==d.readyState&&200==d.status)return b=X[a.url]=d.responseText,b=I(b,a.data,a.tplId),c.isString(a.renderTo)&&(c.getById(a.renderTo).innerHTML+=b),b;throw new Error("Can't find templates file: "+a.url)},I=function(a,b,d){var e,f,g,h,i,j;if(a=a.replace(/\r\n/g,"\n"),a=a.replace(/\r/g,"\n"),a=a.replace(/\\/g,"\\\\"),a=a.replace(/\n/g,""),c.isString(d)){e=a.split("[[#"),f=new RegExp("^"+d+"]]");for(var g=0,h=e.length;h>g;g++)if(e[g].match(f)){a=e[g].replace(f,"");break}}else a=a.replace(/\[\[#[a-zA-Z0-9_-]*\]\]/g,"");return i=a.split("@>"),j=new Function("data",J(i)),j(b)},J=function(a){var b,c,d,e,f=[],g=[],h=[],i="PLN",j="VAL",k="PAS",l="__tempArr__.push(";for(f.push("var __tempArr__ = [];"),b=0,c=a.length;c>b;b++)d=a[b],d.indexOf("<@=")>-1?(e=d.split("<@="),e.length>1?(h.push(e[0].replace(/"/g,'\\"')),h.push(e[1]),g.push(i),g.push(j)):(h.push(e[0]),g.push(j))):d.indexOf("<@")>-1?(e=d.split("<@"),e.length>1?(h.push(e[0].replace(/"/g,'\\"')),h.push(e[1]),g.push(i),g.push(k)):(h.push(e[0]),g.push(k))):(h.push(d.replace(/"/g,'\\"')),g.push(i));for(b=0,c=h.length;c>b;b++)d=h[b],g[b]==j?(d='""+'+d+'+""',f.push(l+d+");")):g[b]==k?f.push(d):(d='"'+d+'"',f.push(l+d+");"));return f.push("return __tempArr__.join('');"),f.join("")};b.log=function(a,b){window.console=window.console||{log:function(){},error:function(){}};var c=new Date,d=c.getFullYear(),e=c.getMonth()+1,f=c.getDate(),g=c.getHours(),h=c.getMinutes(),i=c.getSeconds(),j=c.getMilliseconds();console.log((b?b:"")+d+"/"+e+"/"+f+" "+g+":"+h+":"+i+"."+j+" "+a)},b.debug=function(a){b.isDevelopment&&b.log(a,"[DEBUG]")},b.localSet=function(a){"lang"===T.loadOrder.presentOrder()&&(U=a)},b.msg=function(a){return U[a]?U[a]:a},b.interceptor=function(a,b){r("interceptors",a,b)},b.controller=function(a,b){r("controllers",a,b)},b.model=function(a,b){r("models",a,b)},b.view=function(a,b){r("views",a,b)},b.action=function(a){var d,e,f,g;if(!arguments.length)return b.action;if(f=arguments[0],g=c.toArray(arguments).slice(1),d=f.split("."),0==a.length)throw new Error("tipJS.action : invalid parameter");return T.loadOrder&&T.loadOrder.isLastOrder()?(e=b.action[a],e.apply(e,g),void 0):(L=L||[],L.push({name:f,param:g}),void 0)},b.loadApp=function(){var a;M&&(a=c.toArray(arguments),a.length&&(T.onLoadArgs=a),N(),delete b.loadApp)},b.app=function(a){M=a};var K,L,M,N=function(){var a,d=M;if(c.mergeObject(d,R.define),null===b.isDevelopment){for(a=d.developmentHostList.length;a--;)if(null!==Z.hostname.match(d.developmentHostList[a])){b.isDevelopment=!0;break}if(!b.isDevelopment)for(a=d.releaseHostList.length;a--;)if(null!==Z.hostname.match(d.releaseHostList[a])){b.isRelease=!0;break}}T.define=d,c.mergeObject(T.loadOrder={},R.loadOrder),b.isRelease&&(T.loadOrder.order=["lang","tipJSRelease"]),t(T.loadOrder.presentOrder())},O={},P={interceptors:{},controllers:{},models:{},views:{}},Q=[],R={define:{noCache:!1,noCacheVersion:b.ver,noCacheParam:"tipJS",noCacheAuto:!1,getNoCacheUrl:function(a){return this.noCache===!1?a:(a+=a.indexOf("?")<0?"?":"&",a+=this.noCacheParam+"="+(this.noCacheAuto===!0?""+Math.random():this.noCacheVersion))},templateCache:!0,path:{lang:"lang",interceptors:"interceptors",controllers:"controllers",models:"models",views:"views"},releaseFile:"tipJSFile.js",developmentHostList:[],releaseHostList:[],lang:[],interceptors:[],controllers:[],models:[],views:[],routes:[],localSet:!1,onLoad:function(){},beforeController:function(){},afterController:function(){},getModel:u,getView:v},loadOrder:{index:0,presentOrder:function(){return this.order[this.index]},nextOrder:function(){return this.order[++this.index]},isLastOrder:function(){return this.index+1==this.order.length},order:["lang","interceptors","controllers","models","views"]}},S={},T={},U={},V={},W=[],X={},Y={},Z=window.location,$=Z.pathname,_=Z.search,ab=null,bb=(navigator.language||navigator.systemLanguage||navigator.userLanguage).substr(0,2);(null!==_.match("(\\?|&)debug")||null!==$.match("debug"))&&(ab=!0),b.lang=bb,b.isDevelopment=ab}(this);